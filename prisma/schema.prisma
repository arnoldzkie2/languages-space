generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

model Client {
  id           String       @id @default(uuid())
  profile      String?      @db.Text
  name         String
  user_name    String       @unique
  phone_number String?
  email        String?
  gender       String?
  cards        ClientCard[]
  organization String?
  password     String
  address      String?
  origin       Json?
  note         String?
  departments  Department[]
  created_at   DateTime     @default(now())
  updated_at   DateTime     @updatedAt
  orders       Order[]
  bookings     Booking[]
  Reminders    Reminders[]
}

model ClientCard {
  id                String         @id @default(uuid())
  name              String
  price             Float
  balance           Int
  validity          String
  client            Client         @relation(fields: [clientID], references: [id], onDelete: Cascade)
  clientID          String
  quantity          Int
  invoice           Boolean
  repeat_purchases  Boolean
  online_renews     Boolean
  settlement_period String
  created_at        DateTime       @default(now())
  updated_at        DateTime       @updatedAt
  card              ClientCardList @relation(fields: [cardID], references: [id])
  cardID            String

  @@index([clientID])
  @@index([cardID])
}

model ClientCardList {
  id                  String          @id @default(uuid())
  name                String
  sold                Int
  price               Int
  balance             Int
  validity            Int
  available           Boolean
  quantity            Int
  invoice             Boolean
  repeat_purchases    Boolean
  online_renews       Boolean
  settlement_period   String
  productID           String
  productPriceID      String
  created_at          DateTime        @default(now())
  updated_at          DateTime        @updatedAt
  orders              Order[]
  supported_courses   Courses[]
  supported_suppliers SupplierPrice[]
  active              ClientCard[]
  department          Department     @relation(fields: [departmentID], references: [id])
  departmentID        String

  @@index([departmentID])
}

model Courses {
  id              String           @id @default(uuid())
  name            String
  created_at      DateTime         @default(now())
  updated_at      DateTime         @updatedAt
  supported_cards ClientCardList[]
  booking         Booking[]
  Reminders       Reminders[]
}

model Supplier {
  id                String                @id @default(uuid())
  profile           String?
  name              String
  user_name         String                @unique
  organization      String?
  payment_info      String?
  phone_number      String?
  password          String
  email             String?
  address           String?
  gender            String?
  card              Json?
  tags              Json?
  origin            String?
  note              String?
  employment_status String?
  entry             DateTime?
  departure         DateTime?
  created_at        DateTime              @default(now())
  updated_at        DateTime              @updatedAt
  meeting_info      SupplierMeetingInfo[]
  schedule          SupplierSchedule[]
  supplier_price    SupplierPrice[]
  bookings          Booking[]
  departments       Department[]
  Reminders         Reminders[]
}

model SupplierPrice {
  id           String         @id @default(uuid())
  price        Int
  clientCardID String
  supplierID   String
  cardID       String
  supplier     Supplier       @relation(fields: [supplierID], references: [id], onDelete: Cascade)
  card         ClientCardList @relation(fields: [cardID], references: [id], onDelete: Cascade)

  @@index([supplierID])
  @@index([cardID])
}

model SupplierMeetingInfo {
  id           String   @id @default(uuid())
  service      String
  meeting_code String
  supplierID   String
  created_at   DateTime @default(now())
  updated_at   DateTime @updatedAt
  supplier     Supplier @relation(fields: [supplierID], references: [id], onDelete: Cascade)

  @@index([supplierID])
}

model SupplierSchedule {
  id          String     @id @default(uuid())
  supplierID  String
  date        String
  time        String
  status      String
  clientName  String?
  clientID    String?
  created_at  DateTime   @default(now())
  updated_at  DateTime   @updatedAt
  supplier    Supplier   @relation(fields: [supplierID], references: [id], onDelete: Cascade)
  booking     Booking?   @relation(fields: [bookingID], references: [id], onDelete: Cascade)
  bookingID   String?
  Reminders   Reminders? @relation(fields: [remindersID], references: [id])
  remindersID String?

  @@index([supplierID])
  @@index([bookingID])
  @@index([remindersID])
}

model Booking {
  id           String             @id @default(uuid())
  name         String
  operator     String
  status       String
  note         String?
  scheduleID   String
  supplierID   String
  clientID     String
  card_name    String
  clientCardID String
  price        Int
  meeting_info Json
  created_at   DateTime           @default(now())
  updated_at   DateTime           @updatedAt
  course       Courses            @relation(fields: [courseID], references: [id])
  schedule     SupplierSchedule[]
  supplier     Supplier           @relation(fields: [supplierID], references: [id], onDelete: Cascade)
  client       Client             @relation(fields: [clientID], references: [id], onDelete: Cascade)
  department   Department         @relation(fields: [departmentID], references: [id])
  courseID     String
  departmentID String

  @@index([supplierID])
  @@index([clientID])
  @@index([courseID])
  @@index([departmentID])
}

model Reminders {
  id           String             @id @default(uuid())
  name         String
  operator     String
  status       String
  note         String?
  scheduleID   String
  supplierID   String
  clientID     String
  departmentID String
  card_name    String
  clientCardID String
  price        Int
  meeting_info Json
  created_at   DateTime           @default(now())
  updated_at   DateTime           @updatedAt
  course       Courses            @relation(fields: [courseID], references: [id])
  schedule     SupplierSchedule[]
  supplier     Supplier           @relation(fields: [supplierID], references: [id], onDelete: Cascade)
  client       Client             @relation(fields: [clientID], references: [id], onDelete: Cascade)
  department   Department         @relation(fields: [departmentID], references: [id])
  courseID     String

  @@index([supplierID])
  @@index([clientID])
  @@index([courseID])
  @@index([departmentID])
}

model Agent {
  id                  String       @id @default(uuid())
  profile             String?
  name                String
  user_name           String       @unique
  password            String
  organization        Json?
  payment_information Json?
  phone_number        String?
  email               String?
  address             String?
  gender              String?
  origin              String
  note                String?
  agentCardID         String?
  created_at          DateTime     @default(now())
  updated_at          DateTime     @updatedAt
  card                AgentCard?   @relation(fields: [agentCardID], references: [id], onDelete: Cascade)
  departments         Department[]

  @@index([agentCardID])
}

model AgentCard {
  id         String   @id @default(uuid())
  type       Json
  name       String
  link       String
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
  agent      Agent[]
}

model Order {
  id             String         @id @unique @default(uuid())
  quantity       Int
  price          Float
  operator       String
  status         String
  note           String?
  invoice_number String?
  express_number String?
  created        DateTime       @default(now())
  cardID         String
  clientID       String
  created_at     DateTime       @default(now())
  updated_at     DateTime       @updatedAt
  card           ClientCardList @relation(fields: [cardID], references: [id], onDelete: Cascade)
  client         Client         @relation(fields: [clientID], references: [id], onDelete: Cascade)
  departments    Department[]

  @@index([clientID])
  @@index([cardID])
}

model Admin {
  id          String       @id @default(uuid())
  name        String
  user_name   String       @unique
  email       String
  password    String
  created_at  DateTime     @default(now())
  updated_at  DateTime     @updatedAt
  departments Department[]
}

model SuperAdmin {
  id         String   @id @default(uuid())
  user_name  String   @unique
  password   String
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
}

model Department {
  id         String           @id @default(uuid())
  name       String
  created_at DateTime         @default(now())
  updated_at DateTime         @updatedAt
  clients    Client[]
  news       News[]
  agents     Agent[]
  suppliers  Supplier[]
  admins     Admin[]
  orders     Order[]
  bookings   Booking[]
  cards      ClientCardList[]
  reminders  Reminders[]
}

model News {
  id            String      @id @default(uuid())
  title         String      @db.Text
  author        String
  keywords      Json?
  content       String      @db.Text
  department_id String?
  created_at    DateTime    @default(now())
  updated_at    DateTime    @updatedAt
  department    Department? @relation(fields: [department_id], references: [id], onDelete: Cascade)

  @@index([department_id])
}
